# 11章 オンコール対応
- オンコール : 呼べばすぐ来ること。待機していること。
- SRE : Site Reliability Engineering
- SLO : Service Level Objectives : サービスレベル目標

## 11.1 イントロダクション
- SREはその名の通りエンジニアリングの活用に重きをおいている。
- 運用作業50%、エンジニアリングに50%の時間を使用する。

## 11.2 オンコールエンジニアの日常生活
- 時間的要求が厳しいサービスでは5分、それほど要求が厳しくない場合には30分で対応を求められる。
- 99.99%の可用性を達成する必要があるサービスの場合、四半期で許容される停止時間はほぼ13分。
- 多くのチームではプライマリとセカンダリのオンコールローテーションを持っている。
  - 負担の配分はチームによって異なる。

## 11.3 バランスの取れたオンコール
- オンコールシフトの軸
  - 量 : エンジニアがオンコール担当に費やす時間の割合。
  - 質 : オンコールシフト中に生じたインシデント数。
- 負荷のバランスを取る必要がある。

### 11.3.1 量におけるバランス
- 50%はエンジニアリング、25%以下でオンコール対応、25%で運用業務。
- マルチサイトのチームのすゝめ
  - 「太陽を追いかける」ローテーションを取ることによって、夜間シフトを避けられる。
  - エンジニアがプロダクションシステムとの接点を持ち続けられるようになる。
    - 夜間はプッシュ（ソフトウェアを特定環境にデプロイ）は行わない場合が多いため。
- ただ、マルチサイトはコミュニケーションが大変なのでシステムの重要性や負荷に基づいて決めるべき。

### 11.3.2 質におけるバランス
- インシデント対応の平均は6時間。
- つまり12時間のオンコールシフト中に対応できるのは2件まで。
- 超えるような事があれば対処すべき。

### 11.3.3 補償
- 時間外のサポートについては適切な補償をすべき。
- 休みと金。

## 11.4 安心感
- 困難に直面した時に人が選択する考え方には2つある
  - 直感的かつ反射的に即行動しようとする。
  - 理性的かつ集中を保ち、慎重な認識を働かせようとする。 ←こちらが良い。
- ストレスを減らすことが重要。
- オンコールを担当するという負担を軽いものにしてくれるようなリソース。
  - 明確なエスカレーションパス
  - しっかり規定されたインシデント管理の手順
  - 避難を伴わないポストモーテム文化
    - ポストモーテムとはプロジェクトの終了後、プロジェクトを振り返って行う「事後検証」のこと

## 11.5 不適切な運用不可の回避
- 運用業務に費やす時間が50%を超えたらどうなるのか。

### 11.5.1 運用の過負荷
- 過負荷かどうかを判断する数値を設定する。
  - 例 : 日々のチケット数、シフトごとのページ発生イベント数など
- 優先度の低いアラームは減らす。
- アラートはまとめる。
  - 重複や１つのアラートから発生するアラートなど。
- 場合によってはSREチームの基準に達するまで開発チームに渡すことも考慮する。
  - 分担を交渉できるという事はチームバランスが保たれていることの証明。

### 11.5.2 油断ならない敵 : 低すぎる運用負荷
- 静かすぎると。
  - プロダクトとの接点が減る。
  - インシデントを対応した時に知識とのギャップが表面化することになる。
- 全てのエンジニアがオンコール担当を担当できるようにすべき。
- 障害の訓練を行ったりすると良い。

## 11.6 まとめ
- 略
